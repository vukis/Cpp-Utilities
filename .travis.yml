language: cpp
# To get the Trusty image, not actually required
sudo: required

addons:
  apt:
    source: &sources
     - llvm-toolchain-precise-4.0.1
     - ubuntu-toolchain-r-test
    packages: &base_build
     - libboost-all-dev
#     - libcppunit-dev
    packages: &base_build_gpp_latest
 #    - *base_build
     - g++-4.9
#    packages: &base_build_clang_latest
#     - *base_build
#     - clang-4.0.1

os:
    - linux
#    - osx

compiler:
    - gcc
    - clang

env:
    - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=x86 BUILD_CONFIGURATION=Release
    - TARGET_CPU=x64 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=x64 BUILD_CONFIGURATION=Release
    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
 
#matrix:
#    exclude:
#        - os:       osx
#          compiler: gcc

#        - os:  osx
#          env: TARGET_CPU=x86 BUILD_CONFIGURATION=Debug

#        - os:  osx
#          env: TARGET_CPU=x86 BUILD_CONFIGURATION=Release

before_install:
  # C++17
  #- if [ "$CXX" == "g++" ]; then sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test; fi
  #- if [ "$CXX" == "clang++" ]; then sudo add-apt-repository -y ppa:h-rayflood/llvm; fi
  - sudo apt-get update -qq
  #- sudo apt-get install libboost-all-dev
  
install: 
  # C++17
  #- if [ "$CXX" == "g++" ]; then sudo apt-get install -qq g++-7; fi
  #- if [ "$CXX" == "g++" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90; fi
  #- if [ "$CXX" == "clang++" ]; then sudo apt-get install -qq clang-4.0.1; fi
  # cppcheck
  # - sudo apt-get install -qq cppcheck  
  
script:
    # Build and run this project
    - mkdir build
    - cd build
    - cmake .. -DTARGET_CPU=$TARGET_CPU -DCMAKE_BUILD_TYPE=$BUILD_CONFIGURATION
    - make
    #- ctest --output-on-failure