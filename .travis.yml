language: cpp
# To get the Trusty image, not actually required
sudo: required

addons:
  apt:
    source: &sources
     #- llvm-toolchain-trusty-4.0
     - ubuntu-toolchain-r-test
    packages: &base_build
     - libboost-all-dev
#     - libcppunit-dev
    packages: &base_build_gpp_latest
     - *base_build
     - g++-7
    packages: &base_build_clang_latest
     #- *base_build
     #- clang-4.0

os:
    - linux
#    - osx

compiler:
    - gcc
    #- clang

env: &configurations
    - TARGET_CPU=x86 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=x86 BUILD_CONFIGURATION=Release
    - TARGET_CPU=x64 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=x64 BUILD_CONFIGURATION=Release
    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Debug
    - TARGET_CPU=amd64 BUILD_CONFIGURATION=Release
 

#- llvm-toolchain-precise
#    exclude:
#        - os:       osx
#          compiler: gcc

#        - os:  osx
#          env: TARGET_CPU=x86 BUILD_CONFIGURATION=Debug

#        - os:  osx
#          env: TARGET_CPU=x86 BUILD_CONFIGURATION=Release

before_install:
  # C++17
  #- if [ "$CXX" == "g++" ]; then sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test; fi
  #- if [ "$CXX" == "clang++" ]; then sudo add-apt-repository -y ppa:h-rayflood/llvm; fi
  # - sudo apt-get update -qq
  #- sudo apt-get install libboost-all-dev
  
#  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
#  - sudo apt-get update -qq
#  - sudo apt-get install libboost-all-dev
  #- if [ "$CXX" == "g++" ]; then sudo apt-get install -qq g++-7; fi
  #- if [ "$CXX" == "g++" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90; fi
  
 # - if [ "$CXX" == "clang++" ]; then sudo apt-get install -qq libstdc++-7-dev; fi
  
  #- if [ "$CXX" == "clang++" ]; then sudo add-apt-repository -y ppa:h-rayflood/llvm; fi
  #- sudo add-apt-repository -y ppa:h-rayflood/llvm
  
  
  #- sudo apt-add-repository "deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main"
  #- sudo wget -O - http://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add - # Fingerprint: 6084 F3CF 814B 57C1 CF12 EFD5 15CF 4D18 AF4F 7421
  #- sudo apt-get update -qq
  #- sudo apt-get install -qq clang-5.0 lldb-5.0 lld-5.0

  #lldb-3.8
  
  
 # - if [ "$CXX" = "g++" ]; then export CXX="g++-4.8" CC="gcc-4.8"; fi  
  
install: 
  # C++17
 # - if [ "$CXX" == "g++" ]; then sudo apt-get install -qq g++-7; fi
 # - if [ "$CXX" == "g++" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90; fi
  #- if [ "$CXX" == "clang++" ]; then sudo apt-get install -qq clang-4.0.1; fi
  #- sudo apt-get install -qq clang-4.0.0;
  # cppcheck
  # - sudo apt-get install -qq cppcheck  
  
script:
    # Build and run this project
    - mkdir build
    - cd build
    - cmake .. -DTARGET_CPU=$TARGET_CPU -DCMAKE_BUILD_TYPE=$BUILD_CONFIGURATION
    - make
    #- ctest --output-on-failure